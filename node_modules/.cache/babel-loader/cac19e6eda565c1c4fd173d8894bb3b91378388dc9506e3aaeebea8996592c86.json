{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import HeaderComponent from\"../components/Header-component\";import FooterComponent from\"../components/Footer-component\";import DiceRollerButton from\"../components/DiceRollerButton\";import CharacterCard from\"../Character/CharacterCard-component\";import SystemModal from\"../Character/CreateCharacter/SystemModal-component\";import UserProfile from\"../components/UserProfile-component\";// Імпортуємо компонент профілю\nimport\"../styles/Home-styles.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MyProfilePage=()=>{const[characters,setCharacters]=useState([]);const[isSystemModalVisible,setIsSystemModalVisible]=useState(false);const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem(\"token\");const username=localStorage.getItem(\"username\");if(!token||!username){navigate(\"/login\");// Redirect to login if not authenticated\nreturn;}fetch(\"/api/characters\",{method:\"GET\",headers:{Authorization:\"Bearer \".concat(token)// Include token in the header\n}}).then(res=>{if(!res.ok){throw new Error(\"Failed to fetch characters\");}return res.json();}).then(data=>{// Filter characters by the logged-in user's username\nconst userCharacters=data.filter(character=>character.user===username);setCharacters(userCharacters);}).catch(err=>console.error(\"Error fetching characters:\",err));},[navigate]);const handleSystemSelect=(system,version)=>{setIsSystemModalVisible(false);navigate(\"/create-character/\".concat(system,\"/\").concat(version));};const handleLogout=()=>{localStorage.removeItem(\"token\");// Remove token\nlocalStorage.removeItem(\"username\");// Remove username\nnavigate(\"/login\");// Redirect to login page\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"home-page\",children:[/*#__PURE__*/_jsx(HeaderComponent,{}),/*#__PURE__*/_jsx(UserProfile,{onLogout:handleLogout}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"home-page__content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"character-grid\",children:[characters.map(character=>/*#__PURE__*/_jsx(CharacterCard,{character:character},character.id)),/*#__PURE__*/_jsx(CharacterCard,{onAddClick:()=>setIsSystemModalVisible(true)})]})}),isSystemModalVisible&&/*#__PURE__*/_jsx(SystemModal,{onClose:()=>setIsSystemModalVisible(false),onSystemSelect:handleSystemSelect}),/*#__PURE__*/_jsx(DiceRollerButton,{}),/*#__PURE__*/_jsx(FooterComponent,{})]});};export default MyProfilePage;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","HeaderComponent","FooterComponent","DiceRollerButton","CharacterCard","SystemModal","UserProfile","jsx","_jsx","jsxs","_jsxs","MyProfilePage","characters","setCharacters","isSystemModalVisible","setIsSystemModalVisible","navigate","token","localStorage","getItem","username","fetch","method","headers","Authorization","concat","then","res","ok","Error","json","data","userCharacters","filter","character","user","catch","err","console","error","handleSystemSelect","system","version","handleLogout","removeItem","className","children","onLogout","map","id","onAddClick","onClose","onSystemSelect"],"sources":["/home/mbohach/Документи/personal/tabletop/src/pages/MyProfile-page.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport HeaderComponent from \"../components/Header-component\";\nimport FooterComponent from \"../components/Footer-component\";\nimport DiceRollerButton from \"../components/DiceRollerButton\";\nimport CharacterCard from \"../Character/CharacterCard-component\";\nimport SystemModal from \"../Character/CreateCharacter/SystemModal-component\";\nimport UserProfile from \"../components/UserProfile-component\"; // Імпортуємо компонент профілю\nimport \"../styles/Home-styles.css\";\n\nconst MyProfilePage = () => {\n  const [characters, setCharacters] = useState([]);\n  const [isSystemModalVisible, setIsSystemModalVisible] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    const username = localStorage.getItem(\"username\");\n\n    if (!token || !username) {\n      navigate(\"/login\"); // Redirect to login if not authenticated\n      return;\n    }\n\n    fetch(\"/api/characters\", {\n      method: \"GET\",\n      headers: {\n        Authorization: `Bearer ${token}`, // Include token in the header\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          throw new Error(\"Failed to fetch characters\");\n        }\n        return res.json();\n      })\n      .then((data) => {\n        // Filter characters by the logged-in user's username\n        const userCharacters = data.filter((character) => character.user === username);\n        setCharacters(userCharacters);\n      })\n      .catch((err) => console.error(\"Error fetching characters:\", err));\n  }, [navigate]);\n\n  const handleSystemSelect = (system, version) => {\n    setIsSystemModalVisible(false);\n    navigate(`/create-character/${system}/${version}`);\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\"); // Remove token\n    localStorage.removeItem(\"username\"); // Remove username\n    navigate(\"/login\"); // Redirect to login page\n  };\n\n  return (\n    <div className=\"home-page\">\n      <HeaderComponent />\n      <UserProfile onLogout={handleLogout} /> {/* Додаємо компонент профілю */}\n      <div className=\"home-page__content\">\n        <div className=\"character-grid\">\n          {characters.map((character) => (\n            <CharacterCard key={character.id} character={character} />\n          ))}\n          <CharacterCard onAddClick={() => setIsSystemModalVisible(true)} />\n        </div>\n      </div>\n      {isSystemModalVisible && (\n        <SystemModal\n          onClose={() => setIsSystemModalVisible(false)}\n          onSystemSelect={handleSystemSelect}\n        />\n      )}\n      <DiceRollerButton />\n      <FooterComponent />\n    </div>\n  );\n};\n\nexport default MyProfilePage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}