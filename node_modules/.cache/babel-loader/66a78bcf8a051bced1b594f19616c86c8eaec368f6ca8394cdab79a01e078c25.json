{"ast":null,"code":"import _objectSpread from\"/home/m-bohach/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0438/personal/tabletop/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import{rollDice}from\"../../DiceRoller/Roll-script\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const CharacterSheetEdit=_ref=>{let{character,onSave,onCancel}=_ref;const[formData,setFormData]=useState(character.sections);const[sections,setSections]=useState([]);const[system,setSystem]=useState(character.system);const[errors,setErrors]=useState({});useEffect(()=>{// Завантаження конфігураційного файлу для вибраної системи\nimport(\"../../../configs/\".concat(system,\".json\")).then(config=>{setSections(config.sections);setErrors({});}).catch(err=>{console.error(\"Error loading config:\",err);setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{system:\"Невідома система.\"}));});},[system]);const handleChange=(e,sectionName)=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[sectionName]:_objectSpread(_objectSpread({},prev[sectionName]),{},{[name]:value})}));};const handleRoll=async(field,sectionName)=>{const rollResult=await rollDice(\"4d6\");const sortedRolls=rollResult.rolls.map(r=>r.value).sort((a,b)=>a-b);const total=sortedRolls.slice(1).reduce((sum,roll)=>sum+roll,0);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[sectionName]:_objectSpread(_objectSpread({},prev[sectionName]),{},{[field]:total})}));};const validateForm=()=>{const newErrors={};sections.forEach(section=>{section.fields.forEach(field=>{if(field.required&&(!formData[section.name]||!formData[section.name][field.name])){newErrors[\"\".concat(section.name,\".\").concat(field.name)]=\"\\u041F\\u043E\\u043B\\u0435 \".concat(field.label,\" \\u0454 \\u043E\\u0431\\u043E\\u0432'\\u044F\\u0437\\u043A\\u043E\\u0432\\u0438\\u043C.\");}});});setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=e=>{e.preventDefault();if(validateForm()){onSave({system,sections:formData});}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"character-form\",children:[sections.map(section=>/*#__PURE__*/_jsxs(\"div\",{className:\"character-form__section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:section.name}),section.fields.map(field=>{var _formData$section$nam;return/*#__PURE__*/_jsxs(\"div\",{className:\"character-form__field\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.label}),/*#__PURE__*/_jsx(\"input\",{name:field.name,type:field.type,value:((_formData$section$nam=formData[section.name])===null||_formData$section$nam===void 0?void 0:_formData$section$nam[field.name])||\"\",onChange:e=>handleChange(e,section.name),required:field.required,className:\"character-form__input\"}),field.rollable&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleRoll(field.name,section.name),children:\"Roll\"}),errors[\"\".concat(section.name,\".\").concat(field.name)]&&/*#__PURE__*/_jsx(\"span\",{className:\"error\",children:errors[\"\".concat(section.name,\".\").concat(field.name)]})]},field.name);})]},section.name)),/*#__PURE__*/_jsxs(\"div\",{className:\"character-form__actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"character-form__button character-form__button--submit\",children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onCancel,className:\"character-form__button character-form__button--cancel\",children:\"Cancel\"})]})]});};","map":{"version":3,"names":["React","useState","useEffect","rollDice","jsx","_jsx","jsxs","_jsxs","CharacterSheetEdit","_ref","character","onSave","onCancel","formData","setFormData","sections","setSections","system","setSystem","errors","setErrors","concat","then","config","catch","err","console","error","prev","_objectSpread","handleChange","e","sectionName","name","value","target","handleRoll","field","rollResult","sortedRolls","rolls","map","r","sort","a","b","total","slice","reduce","sum","roll","validateForm","newErrors","forEach","section","fields","required","label","Object","keys","length","handleSubmit","preventDefault","onSubmit","className","children","_formData$section$nam","type","onChange","rollable","onClick"],"sources":["/home/m-bohach/Документи/personal/tabletop/src/Character/CharacterSheet/CharacterSheetEdit-component.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { rollDice } from \"../../DiceRoller/Roll-script\";\n\nexport const CharacterSheetEdit = ({ character, onSave, onCancel }) => {\n  const [formData, setFormData] = useState(character.sections);\n  const [sections, setSections] = useState([]);\n  const [system, setSystem] = useState(character.system);\n  const [errors, setErrors] = useState({});\n\n  useEffect(() => {\n    // Завантаження конфігураційного файлу для вибраної системи\n    import(`../../../configs/${system}.json`)\n      .then((config) => {\n        setSections(config.sections);\n        setErrors({});\n      })\n      .catch((err) => {\n        console.error(\"Error loading config:\", err);\n        setErrors((prev) => ({\n          ...prev,\n          system: \"Невідома система.\",\n        }));\n      });\n  }, [system]);\n\n  const handleChange = (e, sectionName) => {\n    const { name, value } = e.target;\n    setFormData((prev) => ({\n      ...prev,\n      [sectionName]: {\n        ...prev[sectionName],\n        [name]: value,\n      },\n    }));\n  };\n\n  const handleRoll = async (field, sectionName) => {\n    const rollResult = await rollDice(\"4d6\");\n    const sortedRolls = rollResult.rolls.map(r => r.value).sort((a, b) => a - b);\n    const total = sortedRolls.slice(1).reduce((sum, roll) => sum + roll, 0);\n    setFormData((prev) => ({\n      ...prev,\n      [sectionName]: {\n        ...prev[sectionName],\n        [field]: total,\n      },\n    }));\n  };\n\n  const validateForm = () => {\n    const newErrors = {};\n    sections.forEach((section) => {\n      section.fields.forEach((field) => {\n        if (field.required && (!formData[section.name] || !formData[section.name][field.name])) {\n          newErrors[`${section.name}.${field.name}`] = `Поле ${field.label} є обов'язковим.`;\n        }\n      });\n    });\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (validateForm()) {\n      onSave({ system, sections: formData });\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"character-form\">\n      {sections.map((section) => (\n        <div key={section.name} className=\"character-form__section\">\n          <h3>{section.name}</h3>\n          {section.fields.map((field) => (\n            <div key={field.name} className=\"character-form__field\">\n              <label>{field.label}</label>\n              <input\n                name={field.name}\n                type={field.type}\n                value={formData[section.name]?.[field.name] || \"\"}\n                onChange={(e) => handleChange(e, section.name)}\n                required={field.required}\n                className=\"character-form__input\"\n              />\n              {field.rollable && (\n                <button type=\"button\" onClick={() => handleRoll(field.name, section.name)}>\n                  Roll\n                </button>\n              )}\n              {errors[`${section.name}.${field.name}`] && <span className=\"error\">{errors[`${section.name}.${field.name}`]}</span>}\n            </div>\n          ))}\n        </div>\n      ))}\n      <div className=\"character-form__actions\">\n        <button type=\"submit\" className=\"character-form__button character-form__button--submit\">\n          Save\n        </button>\n        <button\n          type=\"button\"\n          onClick={onCancel}\n          className=\"character-form__button character-form__button--cancel\"\n        >\n          Cancel\n        </button>\n      </div>\n    </form>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}