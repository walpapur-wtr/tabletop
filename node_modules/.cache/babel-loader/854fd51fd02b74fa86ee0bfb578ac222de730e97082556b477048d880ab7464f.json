{"ast":null,"code":"var _jsxFileName = \"/home/mbohach/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0438/personal/tabletop/src/Character/CharacterSheet/CharacterSheetEdit-component.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { rollDice } from \"../../DiceRoller/Roll-script\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CharacterSheetEdit = ({\n  character,\n  onSave,\n  onCancel\n}) => {\n  _s();\n  const [formData, setFormData] = useState(character.sections);\n  const [sections, setSections] = useState([]);\n  const [system, setSystem] = useState(character.system);\n  const [errors, setErrors] = useState({});\n  useEffect(() => {\n    // Завантаження конфігураційного файлу для вибраної системи\n    import(`../../../configs/${system}.json`).then(config => {\n      setSections(config.sections);\n      setErrors({});\n    }).catch(err => {\n      console.error(\"Error loading config:\", err);\n      setErrors(prev => ({\n        ...prev,\n        system: \"Невідома система.\"\n      }));\n    });\n  }, [system]);\n  const handleChange = (e, sectionName) => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [sectionName]: {\n        ...prev[sectionName],\n        [name]: value\n      }\n    }));\n  };\n  const handleRoll = async (field, sectionName) => {\n    const rollResult = await rollDice(\"4d6\");\n    const sortedRolls = rollResult.rolls.map(r => r.value).sort((a, b) => a - b);\n    const total = sortedRolls.slice(1).reduce((sum, roll) => sum + roll, 0);\n    setFormData(prev => ({\n      ...prev,\n      [sectionName]: {\n        ...prev[sectionName],\n        [field]: total\n      }\n    }));\n  };\n  const validateForm = () => {\n    const newErrors = {};\n    sections.forEach(section => {\n      section.fields.forEach(field => {\n        if (field.required && (!formData[section.name] || !formData[section.name][field.name])) {\n          newErrors[`${section.name}.${field.name}`] = `Поле ${field.label} є обов'язковим.`;\n        }\n      });\n    });\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n  const handleSubmit = e => {\n    e.preventDefault();\n    if (validateForm()) {\n      onSave({\n        system,\n        sections: formData\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"character-form\",\n    children: [sections.map(section => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"character-form__section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: section.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }, this), section.fields.map(field => {\n        var _formData$section$nam;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"character-form__field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: field.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: field.name,\n            type: field.type,\n            value: ((_formData$section$nam = formData[section.name]) === null || _formData$section$nam === void 0 ? void 0 : _formData$section$nam[field.name]) || \"\",\n            onChange: e => handleChange(e, section.name),\n            required: field.required,\n            className: \"character-form__input\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this), field.rollable && /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => handleRoll(field.name, section.name),\n            children: \"Roll\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 17\n          }, this), errors[`${section.name}.${field.name}`] && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"error\",\n            children: errors[`${section.name}.${field.name}`]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 59\n          }, this)]\n        }, field.name, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this);\n      })]\n    }, section.name, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"character-form__actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"character-form__button character-form__button--submit\",\n        children: \"Save\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: onCancel,\n        className: \"character-form__button character-form__button--cancel\",\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n_s(CharacterSheetEdit, \"Yz9RlGwkAiQ6zF1vnVQxUPWkdC8=\");\n_c = CharacterSheetEdit;\nvar _c;\n$RefreshReg$(_c, \"CharacterSheetEdit\");","map":{"version":3,"names":["React","useState","useEffect","rollDice","jsxDEV","_jsxDEV","CharacterSheetEdit","character","onSave","onCancel","_s","formData","setFormData","sections","setSections","system","setSystem","errors","setErrors","then","config","catch","err","console","error","prev","handleChange","e","sectionName","name","value","target","handleRoll","field","rollResult","sortedRolls","rolls","map","r","sort","a","b","total","slice","reduce","sum","roll","validateForm","newErrors","forEach","section","fields","required","label","Object","keys","length","handleSubmit","preventDefault","onSubmit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_formData$section$nam","type","onChange","rollable","onClick","_c","$RefreshReg$"],"sources":["/home/mbohach/Документи/personal/tabletop/src/Character/CharacterSheet/CharacterSheetEdit-component.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { rollDice } from \"../../DiceRoller/Roll-script\";\n\nexport const CharacterSheetEdit = ({ character, onSave, onCancel }) => {\n  const [formData, setFormData] = useState(character.sections);\n  const [sections, setSections] = useState([]);\n  const [system, setSystem] = useState(character.system);\n  const [errors, setErrors] = useState({});\n\n  useEffect(() => {\n    // Завантаження конфігураційного файлу для вибраної системи\n    import(`../../../configs/${system}.json`)\n      .then((config) => {\n        setSections(config.sections);\n        setErrors({});\n      })\n      .catch((err) => {\n        console.error(\"Error loading config:\", err);\n        setErrors((prev) => ({\n          ...prev,\n          system: \"Невідома система.\",\n        }));\n      });\n  }, [system]);\n\n  const handleChange = (e, sectionName) => {\n    const { name, value } = e.target;\n    setFormData((prev) => ({\n      ...prev,\n      [sectionName]: {\n        ...prev[sectionName],\n        [name]: value,\n      },\n    }));\n  };\n\n  const handleRoll = async (field, sectionName) => {\n    const rollResult = await rollDice(\"4d6\");\n    const sortedRolls = rollResult.rolls.map(r => r.value).sort((a, b) => a - b);\n    const total = sortedRolls.slice(1).reduce((sum, roll) => sum + roll, 0);\n    setFormData((prev) => ({\n      ...prev,\n      [sectionName]: {\n        ...prev[sectionName],\n        [field]: total,\n      },\n    }));\n  };\n\n  const validateForm = () => {\n    const newErrors = {};\n    sections.forEach((section) => {\n      section.fields.forEach((field) => {\n        if (field.required && (!formData[section.name] || !formData[section.name][field.name])) {\n          newErrors[`${section.name}.${field.name}`] = `Поле ${field.label} є обов'язковим.`;\n        }\n      });\n    });\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (validateForm()) {\n      onSave({ system, sections: formData });\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"character-form\">\n      {sections.map((section) => (\n        <div key={section.name} className=\"character-form__section\">\n          <h3>{section.name}</h3>\n          {section.fields.map((field) => (\n            <div key={field.name} className=\"character-form__field\">\n              <label>{field.label}</label>\n              <input\n                name={field.name}\n                type={field.type}\n                value={formData[section.name]?.[field.name] || \"\"}\n                onChange={(e) => handleChange(e, section.name)}\n                required={field.required}\n                className=\"character-form__input\"\n              />\n              {field.rollable && (\n                <button type=\"button\" onClick={() => handleRoll(field.name, section.name)}>\n                  Roll\n                </button>\n              )}\n              {errors[`${section.name}.${field.name}`] && <span className=\"error\">{errors[`${section.name}.${field.name}`]}</span>}\n            </div>\n          ))}\n        </div>\n      ))}\n      <div className=\"character-form__actions\">\n        <button type=\"submit\" className=\"character-form__button character-form__button--submit\">\n          Save\n        </button>\n        <button\n          type=\"button\"\n          onClick={onCancel}\n          className=\"character-form__button character-form__button--cancel\"\n        >\n          Cancel\n        </button>\n      </div>\n    </form>\n  );\n};\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,QAAQ,QAAQ,8BAA8B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExD,OAAO,MAAMC,kBAAkB,GAAGA,CAAC;EAAEC,SAAS;EAAEC,MAAM;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACrE,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGX,QAAQ,CAACM,SAAS,CAACM,QAAQ,CAAC;EAC5D,MAAM,CAACA,QAAQ,EAAEC,WAAW,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACc,MAAM,EAAEC,SAAS,CAAC,GAAGf,QAAQ,CAACM,SAAS,CAACQ,MAAM,CAAC;EACtD,MAAM,CAACE,MAAM,EAAEC,SAAS,CAAC,GAAGjB,QAAQ,CAAC,CAAC,CAAC,CAAC;EAExCC,SAAS,CAAC,MAAM;IACd;IACA,MAAM,CAAC,oBAAoBa,MAAM,OAAO,CAAC,CACtCI,IAAI,CAAEC,MAAM,IAAK;MAChBN,WAAW,CAACM,MAAM,CAACP,QAAQ,CAAC;MAC5BK,SAAS,CAAC,CAAC,CAAC,CAAC;IACf,CAAC,CAAC,CACDG,KAAK,CAAEC,GAAG,IAAK;MACdC,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEF,GAAG,CAAC;MAC3CJ,SAAS,CAAEO,IAAI,KAAM;QACnB,GAAGA,IAAI;QACPV,MAAM,EAAE;MACV,CAAC,CAAC,CAAC;IACL,CAAC,CAAC;EACN,CAAC,EAAE,CAACA,MAAM,CAAC,CAAC;EAEZ,MAAMW,YAAY,GAAGA,CAACC,CAAC,EAAEC,WAAW,KAAK;IACvC,MAAM;MAAEC,IAAI;MAAEC;IAAM,CAAC,GAAGH,CAAC,CAACI,MAAM;IAChCnB,WAAW,CAAEa,IAAI,KAAM;MACrB,GAAGA,IAAI;MACP,CAACG,WAAW,GAAG;QACb,GAAGH,IAAI,CAACG,WAAW,CAAC;QACpB,CAACC,IAAI,GAAGC;MACV;IACF,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAME,UAAU,GAAG,MAAAA,CAAOC,KAAK,EAAEL,WAAW,KAAK;IAC/C,MAAMM,UAAU,GAAG,MAAM/B,QAAQ,CAAC,KAAK,CAAC;IACxC,MAAMgC,WAAW,GAAGD,UAAU,CAACE,KAAK,CAACC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACR,KAAK,CAAC,CAACS,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,CAAC;IAC5E,MAAMC,KAAK,GAAGP,WAAW,CAACQ,KAAK,CAAC,CAAC,CAAC,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAKD,GAAG,GAAGC,IAAI,EAAE,CAAC,CAAC;IACvElC,WAAW,CAAEa,IAAI,KAAM;MACrB,GAAGA,IAAI;MACP,CAACG,WAAW,GAAG;QACb,GAAGH,IAAI,CAACG,WAAW,CAAC;QACpB,CAACK,KAAK,GAAGS;MACX;IACF,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAMK,YAAY,GAAGA,CAAA,KAAM;IACzB,MAAMC,SAAS,GAAG,CAAC,CAAC;IACpBnC,QAAQ,CAACoC,OAAO,CAAEC,OAAO,IAAK;MAC5BA,OAAO,CAACC,MAAM,CAACF,OAAO,CAAEhB,KAAK,IAAK;QAChC,IAAIA,KAAK,CAACmB,QAAQ,KAAK,CAACzC,QAAQ,CAACuC,OAAO,CAACrB,IAAI,CAAC,IAAI,CAAClB,QAAQ,CAACuC,OAAO,CAACrB,IAAI,CAAC,CAACI,KAAK,CAACJ,IAAI,CAAC,CAAC,EAAE;UACtFmB,SAAS,CAAC,GAAGE,OAAO,CAACrB,IAAI,IAAII,KAAK,CAACJ,IAAI,EAAE,CAAC,GAAG,QAAQI,KAAK,CAACoB,KAAK,kBAAkB;QACpF;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IACFnC,SAAS,CAAC8B,SAAS,CAAC;IACpB,OAAOM,MAAM,CAACC,IAAI,CAACP,SAAS,CAAC,CAACQ,MAAM,KAAK,CAAC;EAC5C,CAAC;EAED,MAAMC,YAAY,GAAI9B,CAAC,IAAK;IAC1BA,CAAC,CAAC+B,cAAc,CAAC,CAAC;IAClB,IAAIX,YAAY,CAAC,CAAC,EAAE;MAClBvC,MAAM,CAAC;QAAEO,MAAM;QAAEF,QAAQ,EAAEF;MAAS,CAAC,CAAC;IACxC;EACF,CAAC;EAED,oBACEN,OAAA;IAAMsD,QAAQ,EAAEF,YAAa;IAACG,SAAS,EAAC,gBAAgB;IAAAC,QAAA,GACrDhD,QAAQ,CAACwB,GAAG,CAAEa,OAAO,iBACpB7C,OAAA;MAAwBuD,SAAS,EAAC,yBAAyB;MAAAC,QAAA,gBACzDxD,OAAA;QAAAwD,QAAA,EAAKX,OAAO,CAACrB;MAAI;QAAAiC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,EACtBf,OAAO,CAACC,MAAM,CAACd,GAAG,CAAEJ,KAAK;QAAA,IAAAiC,qBAAA;QAAA,oBACxB7D,OAAA;UAAsBuD,SAAS,EAAC,uBAAuB;UAAAC,QAAA,gBACrDxD,OAAA;YAAAwD,QAAA,EAAQ5B,KAAK,CAACoB;UAAK;YAAAS,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAC5B5D,OAAA;YACEwB,IAAI,EAAEI,KAAK,CAACJ,IAAK;YACjBsC,IAAI,EAAElC,KAAK,CAACkC,IAAK;YACjBrC,KAAK,EAAE,EAAAoC,qBAAA,GAAAvD,QAAQ,CAACuC,OAAO,CAACrB,IAAI,CAAC,cAAAqC,qBAAA,uBAAtBA,qBAAA,CAAyBjC,KAAK,CAACJ,IAAI,CAAC,KAAI,EAAG;YAClDuC,QAAQ,EAAGzC,CAAC,IAAKD,YAAY,CAACC,CAAC,EAAEuB,OAAO,CAACrB,IAAI,CAAE;YAC/CuB,QAAQ,EAAEnB,KAAK,CAACmB,QAAS;YACzBQ,SAAS,EAAC;UAAuB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAClC,CAAC,EACDhC,KAAK,CAACoC,QAAQ,iBACbhE,OAAA;YAAQ8D,IAAI,EAAC,QAAQ;YAACG,OAAO,EAAEA,CAAA,KAAMtC,UAAU,CAACC,KAAK,CAACJ,IAAI,EAAEqB,OAAO,CAACrB,IAAI,CAAE;YAAAgC,QAAA,EAAC;UAE3E;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CACT,EACAhD,MAAM,CAAC,GAAGiC,OAAO,CAACrB,IAAI,IAAII,KAAK,CAACJ,IAAI,EAAE,CAAC,iBAAIxB,OAAA;YAAMuD,SAAS,EAAC,OAAO;YAAAC,QAAA,EAAE5C,MAAM,CAAC,GAAGiC,OAAO,CAACrB,IAAI,IAAII,KAAK,CAACJ,IAAI,EAAE;UAAC;YAAAiC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA,GAf5GhC,KAAK,CAACJ,IAAI;UAAAiC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAgBf,CAAC;MAAA,CACP,CAAC;IAAA,GApBMf,OAAO,CAACrB,IAAI;MAAAiC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAqBjB,CACN,CAAC,eACF5D,OAAA;MAAKuD,SAAS,EAAC,yBAAyB;MAAAC,QAAA,gBACtCxD,OAAA;QAAQ8D,IAAI,EAAC,QAAQ;QAACP,SAAS,EAAC,uDAAuD;QAAAC,QAAA,EAAC;MAExF;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACT5D,OAAA;QACE8D,IAAI,EAAC,QAAQ;QACbG,OAAO,EAAE7D,QAAS;QAClBmD,SAAS,EAAC,uDAAuD;QAAAC,QAAA,EAClE;MAED;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACF,CAAC;AAEX,CAAC;AAACvD,EAAA,CA1GWJ,kBAAkB;AAAAiE,EAAA,GAAlBjE,kBAAkB;AAAA,IAAAiE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}