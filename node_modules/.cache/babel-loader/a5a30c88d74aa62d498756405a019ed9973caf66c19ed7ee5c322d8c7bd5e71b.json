{"ast":null,"code":"//Home-page.jsx\nimport React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import HeaderComponent from\"../components/Header-component\";import FooterComponent from\"../components/Footer-component.jsx\";import CharacterCard from\"../Character/CharacterCard-component.jsx\";import DiceRollerButton from\"../components/DiceRollerButton.jsx\";import\"../styles/Home-styles.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const HomePage=()=>{const[characters,setCharacters]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem(\"token\");if(!token){navigate(\"/login\");return;}const fetchCharacters=async()=>{try{const response=await fetch(\"/api/characters\",{headers:{\"Authorization\":\"Bearer \".concat(token)}});if(!response.ok){if(response.status===401||response.status===403){// Якщо токен недійсний, видаляємо його і перенаправляємо на логін\nlocalStorage.removeItem(\"token\");localStorage.removeItem(\"username\");navigate(\"/login\");return;}throw new Error(\"Failed to fetch characters\");}const data=await response.json();setCharacters(data.characters||[]);// Переконуємось що characters завжди масив\n}catch(err){console.error(\"Error fetching characters:\",err);setError(err.message);}finally{setLoading(false);}};fetchCharacters();},[navigate]);if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"home-page\",children:[/*#__PURE__*/_jsx(HeaderComponent,{}),/*#__PURE__*/_jsx(\"div\",{className:\"home-page__content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading characters...\"})}),/*#__PURE__*/_jsx(FooterComponent,{})]});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"home-page\",children:[/*#__PURE__*/_jsx(HeaderComponent,{}),/*#__PURE__*/_jsx(\"div\",{className:\"home-page__content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"Error: \",error]})}),/*#__PURE__*/_jsx(FooterComponent,{})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"home-page\",children:[/*#__PURE__*/_jsx(HeaderComponent,{}),/*#__PURE__*/_jsx(\"div\",{className:\"home-page__content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"character-grid\",children:characters.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-characters\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0423 \\u0432\\u0430\\u0441 \\u0449\\u0435 \\u043D\\u0435\\u043C\\u0430\\u0454 \\u043F\\u0435\\u0440\\u0441\\u043E\\u043D\\u0430\\u0436\\u0456\\u0432\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/create-character\"),className:\"create-character-button\",children:\"\\u0421\\u0442\\u0432\\u043E\\u0440\\u0438\\u0442\\u0438 \\u043F\\u0435\\u0440\\u0441\\u043E\\u043D\\u0430\\u0436\\u0430\"})]}):characters.map(character=>/*#__PURE__*/_jsx(CharacterCard,{character:character},character.id||character.name))})}),/*#__PURE__*/_jsx(DiceRollerButton,{}),/*#__PURE__*/_jsx(FooterComponent,{})]});};export default HomePage;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","HeaderComponent","FooterComponent","CharacterCard","DiceRollerButton","jsx","_jsx","jsxs","_jsxs","HomePage","characters","setCharacters","loading","setLoading","error","setError","navigate","token","localStorage","getItem","fetchCharacters","response","fetch","headers","concat","ok","status","removeItem","Error","data","json","err","console","message","className","children","length","onClick","map","character","id","name"],"sources":["/home/mbohach/Документи/personal/tabletop/src/pages/Home-page.jsx"],"sourcesContent":["//Home-page.jsx\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport HeaderComponent from \"../components/Header-component\";\nimport FooterComponent from \"../components/Footer-component.jsx\";\nimport CharacterCard from \"../Character/CharacterCard-component.jsx\";\nimport DiceRollerButton from \"../components/DiceRollerButton.jsx\";\nimport \"../styles/Home-styles.css\";\n\nconst HomePage = () => {\n  const [characters, setCharacters] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    \n    if (!token) {\n      navigate(\"/login\");\n      return;\n    }\n\n    const fetchCharacters = async () => {\n      try {\n        const response = await fetch(\"/api/characters\", {\n          headers: {\n            \"Authorization\": `Bearer ${token}`\n          }\n        });\n\n        if (!response.ok) {\n          if (response.status === 401 || response.status === 403) {\n            // Якщо токен недійсний, видаляємо його і перенаправляємо на логін\n            localStorage.removeItem(\"token\");\n            localStorage.removeItem(\"username\");\n            navigate(\"/login\");\n            return;\n          }\n          throw new Error(\"Failed to fetch characters\");\n        }\n\n        const data = await response.json();\n        setCharacters(data.characters || []); // Переконуємось що characters завжди масив\n      } catch (err) {\n        console.error(\"Error fetching characters:\", err);\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchCharacters();\n  }, [navigate]);\n\n  if (loading) {\n    return (\n      <div className=\"home-page\">\n        <HeaderComponent />\n        <div className=\"home-page__content\">\n          <div className=\"loading\">Loading characters...</div>\n        </div>\n        <FooterComponent />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"home-page\">\n        <HeaderComponent />\n        <div className=\"home-page__content\">\n          <div className=\"error\">Error: {error}</div>\n        </div>\n        <FooterComponent />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"home-page\">\n      <HeaderComponent />\n      <div className=\"home-page__content\">\n        <div className=\"character-grid\">\n          {characters.length === 0 ? (\n            <div className=\"no-characters\">\n              <p>У вас ще немає персонажів</p>\n              <button onClick={() => navigate(\"/create-character\")} className=\"create-character-button\">\n                Створити персонажа\n              </button>\n            </div>\n          ) : (\n            characters.map((character) => (\n              <CharacterCard key={character.id || character.name} character={character} />\n            ))\n          )}\n        </div>\n      </div>\n      <DiceRollerButton />\n      <FooterComponent />\n    </div>\n  );\n};\n\nexport default HomePage;\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,eAAe,KAAM,gCAAgC,CAC5D,MAAO,CAAAC,eAAe,KAAM,oCAAoC,CAChE,MAAO,CAAAC,aAAa,KAAM,0CAA0C,CACpE,MAAO,CAAAC,gBAAgB,KAAM,oCAAoC,CACjE,MAAO,2BAA2B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnC,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACe,KAAK,CAAEC,QAAQ,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAAAiB,QAAQ,CAAGhB,WAAW,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd,KAAM,CAAAmB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACF,KAAK,CAAE,CACVD,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CAEA,KAAM,CAAAI,eAAe,CAAG,KAAAA,CAAA,GAAY,CAClC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,iBAAiB,CAAE,CAC9CC,OAAO,CAAE,CACP,eAAe,WAAAC,MAAA,CAAYP,KAAK,CAClC,CACF,CAAC,CAAC,CAEF,GAAI,CAACI,QAAQ,CAACI,EAAE,CAAE,CAChB,GAAIJ,QAAQ,CAACK,MAAM,GAAK,GAAG,EAAIL,QAAQ,CAACK,MAAM,GAAK,GAAG,CAAE,CACtD;AACAR,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC,CAChCT,YAAY,CAACS,UAAU,CAAC,UAAU,CAAC,CACnCX,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CACA,KAAM,IAAI,CAAAY,KAAK,CAAC,4BAA4B,CAAC,CAC/C,CAEA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAR,QAAQ,CAACS,IAAI,CAAC,CAAC,CAClCnB,aAAa,CAACkB,IAAI,CAACnB,UAAU,EAAI,EAAE,CAAC,CAAE;AACxC,CAAE,MAAOqB,GAAG,CAAE,CACZC,OAAO,CAAClB,KAAK,CAAC,4BAA4B,CAAEiB,GAAG,CAAC,CAChDhB,QAAQ,CAACgB,GAAG,CAACE,OAAO,CAAC,CACvB,CAAC,OAAS,CACRpB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDO,eAAe,CAAC,CAAC,CACnB,CAAC,CAAE,CAACJ,QAAQ,CAAC,CAAC,CAEd,GAAIJ,OAAO,CAAE,CACX,mBACEJ,KAAA,QAAK0B,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB7B,IAAA,CAACL,eAAe,GAAE,CAAC,cACnBK,IAAA,QAAK4B,SAAS,CAAC,oBAAoB,CAAAC,QAAA,cACjC7B,IAAA,QAAK4B,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAC,uBAAqB,CAAK,CAAC,CACjD,CAAC,cACN7B,IAAA,CAACJ,eAAe,GAAE,CAAC,EAChB,CAAC,CAEV,CAEA,GAAIY,KAAK,CAAE,CACT,mBACEN,KAAA,QAAK0B,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB7B,IAAA,CAACL,eAAe,GAAE,CAAC,cACnBK,IAAA,QAAK4B,SAAS,CAAC,oBAAoB,CAAAC,QAAA,cACjC3B,KAAA,QAAK0B,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAC,SAAO,CAACrB,KAAK,EAAM,CAAC,CACxC,CAAC,cACNR,IAAA,CAACJ,eAAe,GAAE,CAAC,EAChB,CAAC,CAEV,CAEA,mBACEM,KAAA,QAAK0B,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB7B,IAAA,CAACL,eAAe,GAAE,CAAC,cACnBK,IAAA,QAAK4B,SAAS,CAAC,oBAAoB,CAAAC,QAAA,cACjC7B,IAAA,QAAK4B,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAC5BzB,UAAU,CAAC0B,MAAM,GAAK,CAAC,cACtB5B,KAAA,QAAK0B,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5B7B,IAAA,MAAA6B,QAAA,CAAG,oIAAyB,CAAG,CAAC,cAChC7B,IAAA,WAAQ+B,OAAO,CAAEA,CAAA,GAAMrB,QAAQ,CAAC,mBAAmB,CAAE,CAACkB,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAC,yGAE1F,CAAQ,CAAC,EACN,CAAC,CAENzB,UAAU,CAAC4B,GAAG,CAAEC,SAAS,eACvBjC,IAAA,CAACH,aAAa,EAAsCoC,SAAS,CAAEA,SAAU,EAArDA,SAAS,CAACC,EAAE,EAAID,SAAS,CAACE,IAA6B,CAC5E,CACF,CACE,CAAC,CACH,CAAC,cACNnC,IAAA,CAACF,gBAAgB,GAAE,CAAC,cACpBE,IAAA,CAACJ,eAAe,GAAE,CAAC,EAChB,CAAC,CAEV,CAAC,CAED,cAAe,CAAAO,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}